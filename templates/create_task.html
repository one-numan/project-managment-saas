{% extends "base.html" %}

{% block title %}Create Task{% endblock %}
{% block header %}Create Task{% endblock %}

{% block content %}

<div class="row">

    <!-- ================= LEFT FORM ================= -->
    <div class="col-md-8">

        <div class="card shadow-sm">
            <div class="card-body">

                <form method="post" action="/lead-manager/projects/{{ project.id }}/tasks/create" >
                <!-- Task Name -->
                    <div class="mb-3">
                        <label class="form-label fw-bold">Task Name</label>
                        <input type="text"
                               name="task"
                               class="form-control"
                               placeholder="Enter task title"
                               required>
                    </div>

                    <!-- Requirement -->
                    <div class="mb-3">
                        <label class="form-label fw-bold">Select Requirement</label>
                        <select name="requirement_id"
                                class="form-select"
                                required>
                            <option value="">Select Requirement</option>
                            {% for req in project.requirements %}
                                <option value="{{ req.id }}">
                                    {{ req.requirement[:80] }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- Developer -->
                    <div class="mb-3">
                        <label class="form-label fw-bold">Assign Developer</label>
                        <select name="developer_id"
                                class="form-select"
                                required>
                            <option value="">Select Developer</option>
                            {% for dev in developers %}
                                <option value="{{ dev.id }}">
                                    {{ dev.name }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- Optional Fields (Future Ready) -->
                    <div class="row">

                        <div class="col-md-6 mb-3">
                            <label class="form-label">Start Date</label>
                            <input type="datetime-local"
                                   name="start_time"
                                   class="form-control">
                        </div>

                        <div class="col-md-6 mb-3">
                            <label class="form-label">End Date</label>
                            <input type="datetime-local"
                                   name="end_time"
                                   class="form-control">
                        </div>

                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit"
                                class="btn btn-success">
                            Create Task
                        </button>

                        <a href="/lead-manager/projects/{{ project.id }}"
                           class="btn btn-outline-secondary">
                            Cancel
                        </a>
                    </div>

                </form>

            </div>
        </div>

    </div>


    <!-- ================= RIGHT PROJECT INFO ================= -->
    <div class="col-md-4">

        <div class="card shadow-sm">
            <div class="card-body">

                <h6 class="fw-bold">Project Info</h6>
                <hr>

                <p>
                    <strong>Name:</strong><br>
                    {{ project.name }}
                </p>

                <p>
                    <strong>Requirements:</strong>
                    {{ project.requirements|length }}
                </p>

                <p>
                    <strong>Total Tasks:</strong>
                    {{ project.tasks|length }}
                </p>

            </div>
        </div>

    </div>

</div>

{% endblock %}
