{% extends "base.html" %}
{% block header %}Project Management{% endblock %}

{% block content %}

<h4>{{ project.name }}</h4>

<a href="/lead-manager/projects/{{ project.id }}/tasks/create"
   class="btn btn-primary mb-3">
    + Create Task
</a>

<h5>Requirements</h5>
<ul class="list-group mb-4">
    {% for req in project.requirements %}
        <li class="list-group-item">
            {{ req.requirement }}
        </li>
    {% else %}
        <li class="list-group-item text-muted">
            No Requirements
        </li>
    {% endfor %}
</ul>

<h5>Tasks</h5>

<table class="table table-bordered">
    <thead>
        <tr>
            <th>#</th>
            <th>Task</th>
            <th>Developer</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>

    <tbody>

    {% for task in project.tasks %}
        <tr>
            <td>{{ loop.index }}</td>
            <td>{{ task.task }}</td>
            <td>
                {{ task.assignee.name if task.assignee else "Not Assigned" }}
            </td>
            <td>
                <span class="badge
                    {% if task.status.name == "COMPLETED" %}
                        bg-success
                    {% elif task.status.name == "IN_PROGRESS" %}
                        bg-warning
                    {% else %}
                        bg-secondary
                    {% endif %}
                ">
                    {{ task.status.value }}
                </span>
            </td>
            <td>

                <a href="/lead-manager/tasks/{{ task.id }}/edit"
                   class="btn btn-sm btn-outline-primary">
                    Edit
                </a>

                <form method="post"
                      action="/lead-manager/tasks/{{ task.id }}/delete"
                      style="display:inline;">
                    <button class="btn btn-sm btn-outline-danger">
                        Delete
                    </button>
                </form>

            </td>
        </tr>

    {% else %}
        <tr>
            <td colspan="5" class="text-center text-muted">
                No Tasks Created
            </td>
        </tr>
    {% endfor %}

    </tbody>
</table>

{% endblock %}
